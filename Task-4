import sys
import subprocess

# --- Auto Install Required Packages ---
packages = ["pandas", "numpy", "matplotlib", "seaborn", "scikit-learn"]

for pkg in packages:
    try:
        __import__(pkg)
    except ImportError:
        print(f"üì¶ Installing {pkg} ...")
        subprocess.check_call([sys.executable, "-m", "pip", "install", pkg])

# --- Import After Install ---
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

# --- Load Dataset with Full Path ---
file_path = D:\internships\Task-4
try:
    df = pd.read_csv(file_path)
    print("‚úÖ Dataset loaded successfully!")
except Exception as e:
    print("‚ùå Could not read dataset:", e)
    exit()

print(df.head())

# --- Features (X) and Target (y) ---
X = df[["TV", "Radio", "Newspaper"]]   # input features
y = df["Sales"]                        # target variable

# --- Train-Test Split ---
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# --- Train Model ---
model = LinearRegression()
model.fit(X_train, y_train)

# --- Predictions ---
y_pred = model.predict(X_test)

# --- Evaluation ---
print("\n‚úÖ Model Evaluation:")
print("Mean Squared Error:", mean_squared_error(y_test, y_pred))
print("R¬≤ Score:", r2_score(y_test, y_pred))

# --- Plot Actual vs Predicted ---
plt.scatter(y_test, y_pred, color="blue")
plt.xlabel("Actual Sales")
plt.ylabel("Predicted Sales")
plt.title("Actual vs Predicted Sales")
plt.show()
